静态ip设置（all）
# /etc/sysconfig/network-scripts/ifcfg-ens33
BOOTPROTO=static
ONBOOT=yes
IPADDR=192.168.79.128
NETMASK=255.255.255.0
GATEWAY=192.168.79.2
DNS1=192.168.79.2

service network restart 重启网络生效
yum install -y net-tools ifconfig查看设置


# vim /etc/hosts追加（all）
192.168.11.111 mastor
192.168.11.112 slaver1


# 关闭防火墙、禁止防火墙开机自启（all）
systemctl stop firewalld     关闭防火墙
systemctl disable firewalld  禁止防火墙开机自启
vim /etc/selinux/config —>   SELINUX=disabled (修改)


# ssh免密登录（all）
ssh-keygen -t rsa
cat ~/.ssh/id_rsa.pub >> ~/.ssh/authorized_keys
chmod 600 ~/.ssh/authorized_keys
scp -r ~/.ssh/ root@slaver1:~/.ssh/


# 配置NTP服务（all）
timedatectl set-timezone Asia/Shanghai

时间
yum install -y ntp
vi /etc/ntp.conf
#####mastor节点#####
#注释原有配置
#server 0.centos.pool.ntp.org iburst
#server 1.centos.pool.ntp.org iburst
#server 2.centos.pool.ntp.org iburst
#server 3.centos.pool.ntp.org iburst
server ntp.aliyun.com #添加指向阿里云ntp服务
#####slaver节点#####
#注释原有配置
#server 0.centos.pool.ntp.org iburst
#server 1.centos.pool.ntp.org iburst
#server 2.centos.pool.ntp.org iburst
#server 3.centos.pool.ntp.org iburst
server mastor 指向mastor

service ntpd restart #重新启动ntp服务
systemctl enable ntpd.service #设置开机自启
ntpdc -c loopinfo #查看与时间同步服务器的时间偏差
ntpq -p #查看当前同步的时间服务器
ntpstat #查看状态
配置成功状态（服务开启后前面出现*说明成功


# swqppiness参数修改（all）
cd /usr/lib/tuned/
grep "vm.swappiness" * -R 查询出后依次修改为0


# 禁用透明页（all）
#touch /var/lock/subsys/local
echo never > /sys/kernel/mm/transparent_hugepage/defrag
echo never > /sys/kernel/mm/transparent_hugepage/enabled
永久生效 在/etc/rc.local 添加上面命令
给与可执行权限：chmod +x /etc/rc.d/rc.local



#jdk安装（all）
rpm -qa | grep java # 查询已安装的java
yum remove java* # 卸载
rpm -ivh jdk-8u181-linux-x64.rpm
vi /etc/profile
#java
export JAVA_HOME=/usr/java/jdk1.8.0_181-amd64
export PATH=$PATH:$JAVA_HOME/bin
export CLASSPATH=.:$CLASSPATH:$JAVA_HOME/lib

source /etc/profile
java -version验证


# 创建/usr/share/java目录，将mysql-jdbc包放过去（all）
mkdir -p /usr/share/java
mv /opt/mysql-j/mysql-connector-java-5.1.34.jar /usr/share/java/mysql-connector-java.jar
mysql-connector-java-5.1.34.jar 一定要命名为mysql-connector-java.jar


#安装mysql（all）
卸载mariadb：rpm -qa|grep mariadb
rpm -e --nodeps mariadb-libs-5.5.60-1.el7_5.x86_64
wget http://repo.mysql.com/mysql57-community-release-el7-8.noarch.rpm
rpm -ivh mysql57-community-release-el7-8.noarch.rpm
yum -y install mysql-community-server
systemctl start mysqld.service #启动数据库
# systemctl restart mysqld.service #重启数据库
systemctl enable mysqld #开机自启
grep "password" /var/log/mysqld.log （后面会出现一个mql密码用以下面的登陆）
mysql -u root -p
ALTER USER 'root'@'localhost' IDENTIFIED BY 'ShouTj@123456';
卸载yum源防止自动更新 yum -y remove mysql57-community-release-el7-8.noarch
（不要）#####安装MySQL-shared-compat或MySQL-shared软件包(这是Cloudera Manager Agent软件包安装所必需的)：
（不要）#####yum install MySQL-shared-advanced

vi /etc/mysql.cnf

#创建cdh默认的数据库
create database scm default character set utf8 default collate utf8_general_ci;
grant all on scm.* to 'scm'@'%' identified by 'ShouTj@123456';
create database amon default character set utf8 default collate utf8_general_ci;
grant all on amon.* to 'amon'@'%' identified by 'ShouTj@123456';
create database rman default character set utf8 default collate utf8_general_ci;
grant all on rman.* to 'rman'@'%' identified by 'ShouTj@123456';
create database hue default character set utf8 default collate utf8_general_ci;
grant all on hue.* to 'hue'@'%' identified by 'ShouTj@123456';
create database metastore default character set utf8 default collate utf8_general_ci;
grant all on metastore.* to 'hive'@'%' identified by 'ShouTj@123456';
create database sentry default character set utf8 default collate utf8_general_ci;
grant all on sentry.* to 'sentry'@'%' identified by 'ShouTj@123456';
create database nav default character set utf8 default collate utf8_general_ci;
grant all on nav.* to 'nav'@'%' identified by 'ShouTj@123456';
create database oozie default character set utf8 default collate utf8_general_ci;
grant all on oozie.* to 'oozie'@'%' identified by 'ShouTj@123456';

flush privileges;


# 安装Httpd服务（mastor）
yum install httpd
systemctl start httpd.service
systemctl enable httpd.service 设置httpd服务开机自启


# 安装第三方依赖包
yum -y install chkconfig python bind-utils psmisc libxslt zlib sqlite cyrus-sasl-plain cyrus-sasl-gssapi fuse fuse-libs redhat-lsb
（不要）#插件
（不要）yum install cloudera-manager-daemons cloudera-manager-agent cloudera-manager-server --skip-broken --nogpgcheck


# 配置Cloudera Manager包yum源（mastor）
mkdir -p /var/www/html/cloudera-repos/cm6/
将下载的cm包文件移到此目录下:/var/www/html/cloudera-repos/cm6/
cd /var/www/html/cloudera-repos/cm6/
创建repodata： createrepo
vim /etc/yum.repos.d/cloudera-manager.repo
#####
[cloudera-manager]
name = Cloudera Manager, Version
baseurl = http://mastor/cloudera-repos/cm6/
gpgcheck = 1
#####

yum clean all
yum makecache
